---
title: "Dissertation Analysis"
author: "Jamiahus Walton"
Date: '2019-02-01'
output:
  html_document: default
    df_print: paged
  word_document: 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Packages for data analysis
library(tidyverse)
library(lme4)
library(lmerTest)
library(emmeans)
library(svMisc)
library(MuMIn)
library(modelr)
library(sjstats)

# Functions used is documents ----
remove_measures_with_given_value <- function(data_set, col_name, value){
  rows_to_move <- which(as.vector(data_set[,col_name]) == value) 
  
  return(data_set[-rows_to_move,])
}

re_factor_columns <- function(userData, columnNames){
  factorData <- userData
  for(column in columnNames){
    print(column)
    factorData[,column] <- factor(factorData[,column])
  }
  return(factorData)
}

#Folder locations ----
main_work_directory_name <- main_work_directory_name <- "C:\\Users\\jamia\\Box\\TMET2\\DATA TMET2\\Data_And_Calcuations\\Raw Data\\"
database_folder_name <- "Database"
file_name_output <- "team_player_aggragate_stats.csv"
folder_location_database <- paste(main_work_directory_name, database_folder_name, sep = "")
aggregate_folder_location <- paste(folder_location_database,"\\", file_name_output, sep = "") #This will combine the final file name and the desiered folder location

# Read aggregaate data ----
my_aggregate_data <- read.csv(file =  aggregate_folder_location)

clean_aggregate_data_stats <- remove_measures_with_given_value(data_set =  my_aggregate_data, col_name = "Condition", value = "A") # without none condition

# Re factor the columns
columns_to_refactor <- c("SessionOrder", 
                         "Team", 
                         "Player_ID", 
                         "Condition", 
                         "Dominate.Strategy", 
                         "Condition", 
                         "Target",
                         "Confident_team_comm_important_details_quickly")
clean_aggregate_data_stats <- re_factor_columns(clean_aggregate_data_stats, columns_to_refactor)

# What is the N for Teams ----
N_teams <- length(levels(factor(clean_aggregate_data_stats$Team)))

# What is the N for Inds ----
N_ind <- length(levels(factor(clean_aggregate_data_stats$Player_ID) ))

# Team data set ----
team_data <- clean_aggregate_data_stats %>%
  filter(Player == 1)

# Individual data set ----
ind_data <- clean_aggregate_data_stats

```

## Purpose

The purpose of this document is to record data analysis for my Dissertation.

## Experimental Design

This is a within subject experimental desing. The main variable was the feedback condition (i.e., Target). The variable levels are None, Individual, Team, and Indvidiaul_Team. Each team expereinced each condition. The first condition for each team was the none condition. The remaining three condition were counter balanced. For example, the condition order for team 7 is the following: None, Ind, Team, Ind_Team. The condition order for team 8 is the following: None, Team, Individual, Individual_Team. 

## Data Description

The data was collected from **`r N_ind`** participants that formed **`r N_teams`** teams. Below is a sample of the data for the main metrics
```{r main_metrics_table, echo=FALSE}
knitr::kable(
  clean_aggregate_data_stats[1:5,c("TeamScore", 
                           "IndividualScore", 
                           "CI_team", 
                           "CI_ind", 
                           "II_team", 
                           "II_ind", 
                           "ERROR_team_unique", 
                           "ERROR_ind_unique", 
                           "ERROR_team_total",
                           "ERROR_ind_total")]
)
```

## Research Question

This research attempts to answer the following question: How will teams' performance change if given feedback that displays indicators based on individual performance, team performance, or both?

## Explore

In this section I seek to visually discover answers that answer the research question mentioned above.

### Q: Is there interesting variation among the *time remaining* that will help me understand the influence of the feedback condition?

#### Team

```{r}
dependent_response_team <- "timeRemaining_team"
y_label_team <- "Count"
x_label_team <- "Time Remaining"
title_response_team <- "Distrabution of Time Remaining (Team)"

plot_data_team <- team_data %>%
  select(dependent_response_team, Target)

ggplot(data = plot_data_team) + 
  geom_histogram(aes_string(x = dependent_response_team), bins = 10) +
  labs(title = title_response_team, x = x_label_team, y = y_label_team)
```

Overall, the distrabution of the time remaining is skwed to the left. This tells me that most of the teams had around 50 seconds left at the end of each session. 

```{r}
dependent_response_team <- "timeRemaining_team"
y_label_team <- "Count"
x_label_team <- "Target"
title_response_team <- "Distrabution of Time Remaining (Team)"

plot_data_team <- team_data %>%
  select(dependent_response_team, Target)

ggplot(data = plot_data_team) + 
  geom_histogram(aes_string(x = dependent_response_team), bins = 15) +
  facet_grid(. ~ Target) +
  labs(title = title_response_team, x = x_label_team)
```

The skewed to the left pattern continues when grouping the time remaining by the feedback conditions. Most of the teams seem to have about 50 seconds remaining when the completed the task. 

*Reflection:* The is skewness in the time reamining data at the team level. This skewness suggests that most of the teams had about the same amount of time remaining at the end of the session (50 or 40 seconds). 

#### Individual

```{r}
dependent_response_ind <- "timeRemaining_ind"
y_label_ind <- "Count"
x_label_ind <- "Time Remaining"
title_response_ind <- "Distrabution of Time Remaining (Individual)"

plot_data_ind <- ind_data %>%
  select(dependent_response_ind, Target)

ggplot(data = plot_data_ind) + 
  geom_histogram(aes_string(x = dependent_response_ind), bins = 40) +
  labs(title = title_response_ind, x = x_label_ind, y = y_label_ind)
```

Overall, the time remaiming at the individual level is skewed to the left. This tells me that most of the participants had a 50 seconds or left at the end of the sessions. I also notice that there area number of data points that are distributed from about 60 to 350. Are there similar characteristics among the teams that have more that 50 seconds remaining at the end of the sessions?

```{r}
dependent_response_ind <- "timeRemaining_ind"
y_label_ind <- "Count"
x_label_ind <- "Time Remaining"
title_response_ind <- "Distrabution of Time Remaining (Individual)"

plot_data_ind <- ind_data %>%
  select(dependent_response_ind, Target)

ggplot(data = plot_data_ind) + 
  geom_histogram(aes_string(x = dependent_response_ind), bins = 30) +
  facet_grid(. ~ Target) +
  labs(title = title_response_ind, x = x_label_ind, y = y_label_ind)
  
```

The distrabution for each condition is similar to the overall condition. This tells me that most individuals finished with about 50 seconds or so left at the end of each session. It seems as though we can say the high performing individuals finished with over 50 seconds or so left at the end of the session. Do the high performing individuals have similar characteristics?

*Reflection:* The distrabution is similar to the distrabution of the time remaining at the team level. The distraution was skewed to the left and most of the time remaining at the end of the session was about 50 or 60 seconds  
  
  
#### Summary / Reflection

Overall, the data looks to be skewed to the left. According to the count at the individual and team level, the teams and players that finished with more than 50 seconds or so left at the end of the session were high performing teams. There did not seem to be any obvious patter when grouping the data by Feedback conditions. Maybe the feedback conditions had an influence on the amount of time remaiming depending on their experience (i.e., session order)? 

### Q: Is there interesting variation among the * time remaining * that explains how the feedback conditions influences the time remaining when session order is taken into consideration?

#### Team

```{r}
dependent_response_team <- "timeRemaining_team"
y_label_team <- "Count"
x_label_team <- "Time Remaining"
title_response_team <- "Distrabution of Time Remaining (Team)"

plot_data_team <- team_data %>%
  select(dependent_response_team, Target, SessionOrder)

ggplot(data = plot_data_team) + 
  geom_histogram(aes_string(x = dependent_response_team), bins = 20) +
  labs(title = title_response_team, x = x_label_team, y = y_label_team) +
  facet_grid( SessionOrder ~ Target)
```

It looks like the time remaining for teams in the individual feedback condition did not change the amount fo time remaining at the end of the session. This is interesting because I would expect the distrabution to spread over time because teams would get better and they would complete the task quciker.   
  
It looks like the time reamining for the individual_team condition seems to spread over time. Meaning that the teams were completing the task faster the more they completed the task. I would not be suprised if the Individual_Team condition was trending to significant.  
  
  
It looks like the distrabution of the amount of time remaining at the end of the session in the team feedback condition starts to spread over time. This is what I would expect to see.

*Reflection:* I would expect to see the distrabution of time remaining spread over time because the teams would learn the task and get better at the task. This pattern is not follwed in the individual condition. The distrabution of the time remaining in the individual condition does not seem to spread over time. The amount of time remaining is consistent no matter what session order (i.e., 2,3, or 4) they are in. This would suggest that giving individual performance metrics does not influence the amount of time remaining at the end of the session for a team. 

#### Individual

```{r}
dependent_response_ind <- "timeRemaining_ind"
y_label_ind <- "Count"
x_label_ind <- "Time Remaining"
title_response_ind <- "Distrabution of Time Remaining (Individual)"

plot_data_ind <- ind_data %>%
  select(dependent_response_ind, Target, SessionOrder)

ggplot(data = plot_data_ind) + 
  geom_histogram(aes_string(x = dependent_response_ind), bins = 30) +
  facet_grid(SessionOrder ~ Target) +
  labs(title = title_response_ind, x = x_label_ind, y = y_label_ind)
```

It looks like the distrabution of the time remaining in the indvidiaul condition does not obviously spread over time. This tells me that the individuals were not getting faster over time in the individual feedback condition. It looks like the spread of the time remaining in the Indivdual_team condtion does spread over time. There is a more obvious spread from session 3 to session 4. It looks like the time remaining in the team condition does spread over time. This is what I would expect. 

*Reflection:* I am getting the sense that the individual condition did not influence how quickly the participants completed the session. In other words, giving the individual feedback on performance metrics did not encourage the participants to move faster through the session. However, it looks like the spread over the time remaining increses when given team or ind_team feedback. This tells me that teams are more likely to move through the task quicker if given individual_team or team feedback not individual feedback. 


#### Summary / Reflection

Overall, the distrabution is teling me that over time, teams move through the task quciker when given team or ind_team feedback but not individual feedback. This suggest that if I looked at the fourth session and group the data by the feedback conditions, I would see that the time remaining in the individual_team and Team condition would be significantly different from the time remaining in the individual condition.


### Exploring Interactions in Performance Metrics

I first want to explore the main performance metrics. The main performance metrics are the score (individual and team), correct items collected, incorrect items collected, errors (total and unique), and time remaining. I want to do this for the individual and team level analysis.

Main question: *Is there an interaction between the Target and SessionOrder variable?*

#### Scores

##### Team

```{r}
plot_data_team <- team_data %>%
  select(Target, SessionOrder, TeamScore, Team) %>%
  mutate(rank_order = -rank(team_data[["TeamScore"]]))

ggplot(data = plot_data_team, aes(x = Target, y = TeamScore, fill = Team, group = rank_order)) +
  geom_bar(stat = "identity", position = "dodge") + 
  facet_grid(. ~ SessionOrder) + 
  guides(fill = FALSE) +
  labs(y = "Score", x = "Target", title = "Team Score Vs. Target", fill = "Teams")
```

Visually, there is not obvious pattern. In slop from the highest scores to the lowest score in the team condition seemes to be a little steeper than than the other conditions.


```{r}
plot_data_team <- team_data %>%
  select(Target, SessionOrder, TeamScore) %>%
  group_by(SessionOrder, Target) %>%
  summarise(TeamScoreAverage = mean(TeamScore), 
            Stdv =sd(TeamScore), n = length(TeamScore), 
            StEr = sd(TeamScore) / sqrt(length(TeamScore)))


ggplot(data = plot_data_team, aes(x = Target, y = TeamScoreAverage, color = SessionOrder, shape = SessionOrder)) +
  geom_point(size = 3) +
  geom_line(aes(group=SessionOrder, color = SessionOrder)) + 
  geom_errorbar(aes(ymin = TeamScoreAverage - StEr, ymax = TeamScoreAverage + StEr), width = 0.2) +
  labs(y = "Score", x = "Target", title = "Team Score Vs. Target", color = "Session", shape = "Session")
```

Visually, there appears to be no interaction between Target and SessionOrder for Team Score dependent variable. 



##### Individual

#### Correct Items Collected

##### Team


```{r}
plot_data_team <- team_data %>%
  select(Target, SessionOrder, CI_team) %>%
  group_by(SessionOrder, Target) %>%
  summarise(CI_teamAverage = mean(CI_team), 
            Stdv =sd(CI_team), n = length(CI_team), 
            StEr = sd(CI_team) / sqrt(length(CI_team)))

ggplot(data = plot_data_team, aes(x = Target, y = CI_teamAverage, color = SessionOrder, shape = SessionOrder)) +
  geom_point(size = 3) +
  geom_line(aes(group=SessionOrder, color = SessionOrder)) + 
  geom_errorbar(aes(ymin = CI_teamAverage - StEr, ymax = CI_teamAverage + StEr), width = 0.2) +
  labs(y = "Count", x = "Target", title = "Correct Items Vs. Target", color = "Session", shape = "Session")
```

Visually, there appears to be no apparent interaction between Target and SessionOrder for Correct Items dependent variable. An argument could be made that there is an interaction between session 3 and 4 and Individual and Individual_Team. The graph suggests that the number of team items collected has little increase from sesssion 3 to session 4. The graph suggests there is a larger increase in correct items collected from session 3 to session 4. These arugements are complicated by the large standard errors.

##### Individual

#### Incorrect Items Collected

##### Team

```{r}
plot_data_team <- team_data %>%
  select(Target, SessionOrder, II_team) %>%
  group_by(SessionOrder, Target) %>%
  summarise(II_teamAverage = mean(II_team), 
            Stdv =sd(II_team), n = length(II_team), 
            StEr = sd(II_team) / sqrt(length(II_team)))

ggplot(data = plot_data_team, aes(x = Target, y = II_teamAverage, color = SessionOrder, shape = SessionOrder)) +
  geom_point(size = 3) +
  geom_line(aes(group=SessionOrder, color = SessionOrder)) + 
  geom_errorbar(aes(ymin = II_teamAverage - StEr, ymax = II_teamAverage + StEr), width = 0.2) +
  labs(y = "Count", x = "Target", title = "Incorrect Items Vs. Target", color = "Session", shape = "Session")
```

Visually, there appears to be some interaction between Target and SessionOrder for Incorrect items. It looks like in the individual condition, the teams collected about the same number of incorrect items. It also looks like participants collected the least amount of incorrect items in the Team and Individual_Team condition. It is difficul to draw conclusions because the standard errors are so large. 

##### Individual


#### Time remaining

##### Team

```{r}
plot_data_team <- team_data %>%
  select(Target, SessionOrder, timeRemaining_team) %>%
  group_by(SessionOrder, Target) %>%
  summarise(timeRemaining_teamAverage = mean(timeRemaining_team), 
            Stdv =sd(timeRemaining_team), n = length(timeRemaining_team), 
            StEr = sd(timeRemaining_team) / sqrt(length(timeRemaining_team)))

ggplot(data = plot_data_team, aes(x = Target, y = timeRemaining_teamAverage, color = SessionOrder, shape = SessionOrder)) +
  geom_point(size = 3) +
  geom_line(aes(group=SessionOrder, color = SessionOrder)) + 
  geom_errorbar(aes(ymin = timeRemaining_teamAverage - StEr, ymax = timeRemaining_teamAverage + StEr), width = 0.2) +
  labs(y = "Time (Sec)", x = "Target", title = "Time Remaining Vs. Target", color = "Session", shape = "Session")
```

Visually, there appears to be no interaction between Target and SessionOrder for time remaining. The graph suggests that time increase the amount of time remaining at the end of the session faster when in the Team condition. In other words, when given team feedback, the amount of time remaning at the end of each session increases faster. 

##### Individual

#### Errors (Total)

##### Team

```{r}
plot_data_team <- team_data %>%
  select(Target, SessionOrder, ERROR_team_total) %>%
  group_by(SessionOrder, Target) %>%
  summarise(ERROR_team_totalAverage = mean(ERROR_team_total), 
            Stdv =sd(ERROR_team_total), n = length(ERROR_team_total), 
            StEr = sd(ERROR_team_total) / sqrt(length(ERROR_team_total)))

ggplot(data = plot_data_team, aes(x = Target, y = ERROR_team_totalAverage, color = SessionOrder, shape = SessionOrder)) +
  geom_point(size = 3) +
  geom_line(aes(group=SessionOrder, color = SessionOrder)) + 
  geom_errorbar(aes(ymin = ERROR_team_totalAverage - StEr, ymax = ERROR_team_totalAverage + StEr), width = 0.2) +
  labs(y = "Count", x = "Target", title = "Total Errors Vs. Target", color = "Session", shape = "Session")
```

Visually, there appears to be no interaction between Target and SessionOrder for the total errors committed.

##### Individual

#### Errors (Unique)

##### Team

```{r}
plot_data_team <- team_data %>%
  select(Target, SessionOrder, ERROR_team_unique) %>%
  group_by(SessionOrder, Target) %>%
  summarise(ERROR_team_uniqueAverage = mean(ERROR_team_unique), 
            Stdv =sd(ERROR_team_unique), n = length(ERROR_team_unique), 
            StEr = sd(ERROR_team_unique) / sqrt(length(ERROR_team_unique)))

ggplot(data = plot_data_team, aes(x = Target, y = ERROR_team_uniqueAverage, color = SessionOrder, shape = SessionOrder)) +
  geom_point(size = 3) +
  geom_line(aes(group=SessionOrder, color = SessionOrder)) + 
  geom_errorbar(aes(ymin = ERROR_team_uniqueAverage - StEr, ymax = ERROR_team_uniqueAverage + StEr), width = 0.2) +
  labs(y = "Count", x = "Target", title = "Unique Errors Vs. Target", color = "Session", shape = "Session")
```

Visually, there appears to be no interaction between Target and SessionOrder for Amount of unique errors committed.

##### Individual

### Exploreing the Influence of Team Strategy on Performance Metrics

(COntent)

#### Scores

##### Team
##### Individual

#### Correct Items Collected

##### Team
##### Individual

#### Incorrect Items Collected

##### Team
##### Individual

#### Time remaining

##### Team
##### Individual

#### Errors (Total)

##### Team
##### Individual

#### Errors (Unique)

##### Team
##### Individual