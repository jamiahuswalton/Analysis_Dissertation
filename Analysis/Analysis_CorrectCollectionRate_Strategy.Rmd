---
title: 'Dissertation Analysis: Correct Item Collection Rate - Strategy'
author: "Jamiahus Walton"
date: "`r Sys.Date()`"
output: 
  html_document: 
    toc: true
editor_options:
  chunk_output_type: inline
csl: apa.csl
bibliography: bibliography.bib
params:
  dependent_response_name_WithSpace: "Correct Collection Rate"
  dependent_response_name_NoSpace: "CorrectCollectionRate"
  dependent_response_team: "Collection_rate_correct_item_team"
  dependent_response_ind: "Collection_rate_correct_item_ind"
  dependent_response_DominateStrategy: "Dominate.Strategy"
  Strategy_GT_name_NoSpace: "Go.Together"
  Strategy_GT_name_WithSpace: "Go Together"
  Strategy_GA_name_NoSpace: "Go.Alone"
  Strategy_GA_name_WithSpace: "Go Alone"
---

```{r setup, include=FALSE, cache=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Tips for formatting in RMarkdown
# Link: https://monashbioinformaticsplatform.github.io/2017-11-16-open-science-training/topics/rmarkdown.html

# Equations
# Link: https://www.calvin.edu/~rpruim/courses/s341/S17/from-class/MathinRmd.html

# Create awesome HTML table with knitr::kableand kableExtra
# LinkL https://haozhu233.github.io/kableExtra/awesome_table_in_html.html

# Examples of how to use the ggrepel package
# Link: https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html#examples

# Packages for data analysis
library(tidyverse)
library(lme4)
library(lmerTest)
library(emmeans)
library(svMisc)
library(MuMIn)
library(modelr)
library(sjstats)
library(robustlmm)
library(ggrepel)
library(knitr)
library(kableExtra)

# Functions used in documents ----
remove_measures_with_given_value <- function(data_set, col_name, value){
  rows_to_move <- which(as.vector(data_set[,col_name]) == value) 
  
  return(data_set[-rows_to_move,])
}

# Factor columns that need it.
re_factor_columns <- function(userData, columnNames){
  factorData <- userData
  for(column in columnNames){
    print(column)
    factorData[,column] <- factor(factorData[,column])
  }
  return(factorData)
}

# Model the data for the team level analysis ----
model_data_Target_Session <- function(df, dependent, model.type, is.team, is.robust){
  
  if(is.team){
    if(model.type == "null" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ 1 + (1|Team)")))
    } else if(model.type == "All"){
      lmer(data = df, as.formula(paste(dependent,"~ Target * SessionOrder + (1|Team)")))
    } else if(model.type == "NoInteraction" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ Target + SessionOrder + (1|Team)")))
    } else if(model.type == "NoInteraction_NoTarget" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ SessionOrder + (1|Team)")))
    } else if(model.type == "NoInteraction_NoSession" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ Target + (1|Team)")))
    } else if(model.type == "null" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ 1 + (1|Team)")))
    } else if(model.type == "All" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ Target * SessionOrder + (1|Team)")))
    } else if(model.type == "NoInteraction" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ Target + SessionOrder + (1|Team)")))
    } else if(model.type == "NoInteraction_NoTarget" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ SessionOrder + (1|Team)")))
    } else if(model.type == "NoInteraction_NoSession" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ Target + (1|Team)")))
    } else{
      stop("Model.type not supported")
    }
  } else {
    # Run this code if individual level model
    if(model.type == "null" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ 1 + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "All" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ Target * SessionOrder + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "NoInteraction" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ Target + SessionOrder + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "NoInteraction_NoTarget" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ SessionOrder + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "NoInteraction_NoSession"){
      lmer(data = df, as.formula(paste(dependent,"~ Target + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "null" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ 1 + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "All" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ Target * SessionOrder + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "NoInteraction" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ Target + SessionOrder + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "NoInteraction_NoTarget" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ SessionOrder + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "NoInteraction_NoSession" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ Target + (1|Team) + (1| Player_ID)")))
    } else{
      stop("Model.type not supported")
    }
  }
}

#Folder locations ----
figure_directory <- "C:\\Users\\jamia\\Box\\TMET2\\DATA TMET2\\Data_And_Calcuations\\Figures"
main_work_directory_name <- "C:\\Users\\jamia\\Box\\TMET2\\DATA TMET2\\Data_And_Calcuations\\Raw Data\\"

database_folder_name <- "Database"
file_name_output <- "team_player_aggragate_stats.csv"
folder_location_database <- paste(main_work_directory_name, database_folder_name, sep = "")
aggregate_folder_location <- paste(folder_location_database,"\\", file_name_output, sep = "") #This will combine the final file name and the desiered folder location

# Read aggregaate data ----
my_aggregate_data <- read.csv(file =  aggregate_folder_location)

clean_aggregate_data_stats <- remove_measures_with_given_value(data_set =  my_aggregate_data, col_name = "Condition", value = "A") # without none condition

# Re factor the columns
columns_to_refactor <- c("SessionOrder", 
                         "Team", 
                         "Player_ID", 
                         "Condition", 
                         "Dominate.Strategy", 
                         "Condition", 
                         "Target",
                         "Confident_team_comm_important_details_quickly")
clean_aggregate_data_stats <- re_factor_columns(clean_aggregate_data_stats, columns_to_refactor)

# What is the N for Teams ----
N_teams <- length(levels(factor(clean_aggregate_data_stats$Team)))

# What is the N for Inds ----
N_ind <- length(levels(factor(clean_aggregate_data_stats$Player_ID) ))

# Team data set ----
team_data <- clean_aggregate_data_stats %>%
  filter(Player == 1)

# Individual data set ----
ind_data <- clean_aggregate_data_stats

```

# Motivation

The motivation for this analysis is to determine if there is a different in the collection rate of correct items. Previous analysis suggests that individuals in the Team condition have higher time remaining. 

Specifically, at the individual level, when teams use Go Alone, model.NoInteracton indicates a significant difference between Ind_Team and Team. Specicially, Time Remaining (square root) is significantly higher in the Team feedback condition, when compared to Ind_Team feedback.

Specifically, at the individual level, wehn teams use the Go Together method, in session 4, model.All indicates a significant difference between Ind_Team and Team, and a difference between Ind and Team condition, indicating that the Team condition produced higher individual Time Remaining (Square root).

The previous analysis does not tell me how well the teams performed (e.g., were they able to collect correct items quickly?). I developed a dependent variable that will tell us how long it took for a team or individual to collect a correct item. I expect teams/individuals in the Team condition to collect correct items quicker than the other conditions. 

# Correct Items Collection Rate (Sec / Item)

I generated Correct Items Collection Rate values for teams at the individual and team level. 

## Team 

The following is the equation for the correct item collection rate:

$$ Collection.Rate_{Team} = \frac{Duration_{team}}{Total.Correct.Items.Collected_{team}} $$
Where $Duration_{team}$ is the amount of time (in seconds) the team spent in a session, $Total.Correct.Items.Collected_{team}$ is the total number of correct items (team or individual) collected during that session by the entire team. If a team collected 0 correct items, the total duration was used (e.g., the collection rate for a team that had a duration of 462 seconds and collected no correct item is 462). 

__Note:__ It is important to note that the lower collection rate the better the team. This is because the units are __Seconds / Items__, meaning that this variable measure the amount of time needed to collect a correct item. 

## Individual

The following is the equation for the correct item collection rate:

$$ Collection.Rate_{ind} = \frac{Duration_{ind}}{Total.Correct.Items.Collected_{ind}} $$

Where $Duration_{ind}$ is the amount of time (in seconds) an individual spent in a session, $Total.Correct.Items.Collected_{ind}$ is the total number of correct items (team or individual) collected during that session by the an individual. If an individual collected 0 correct items, the total duration was used (e.g., the collection rate for an individual that had a duration of 362 seconds and collected no correct item is 362). 

# Q: Is there exciting variation among the _`r params$dependent_response_name_WithSpace`_ metric that will help me understand the influence of the feedback condition?

## Team

```{r cache=FALSE}
y_label_team <- "Count"
x_label_team <- params$dependent_response_name_WithSpace
title_response_team <- paste("Distribution of", params$dependent_response_name_WithSpace, "(Team)")
plot_name <- paste("Histogram_", params$dependent_response_name_NoSpace, "_Team.png", sep = "")
setwd(figure_directory)

plot_data_team <- team_data %>%
  select(params$dependent_response_team, 
         params$dependent_response_DominateStrategy, 
         Target)

ggplot(data = plot_data_team) + 
  geom_histogram(aes_string(x = params$dependent_response_team), bins = 30) +
  facet_grid( . ~ .data[[params$dependent_response_DominateStrategy]]) +
  labs(title = title_response_team, x = x_label_team, y = y_label_team) +
  ggsave(filename = plot_name)
```

There seems to be a similar distribution of correct collection rate. Both seem to be normal. 

```{r cache=FALSE}
y_label_team <- "Count"
x_label_team <- "Target"
title_response_team <- paste("Distribution of", params$dependent_response_name_WithSpace, "(Team)")
plot_name <- paste("Histogram_", params$dependent_response_name_NoSpace, "_ByTarget_Team.png", sep = "")
setwd(figure_directory)

plot_data_team <- team_data %>%
  select(params$dependent_response_team, 
         params$dependent_response_DominateStrategy, 
         Target)

ggplot(data = plot_data_team) + 
  geom_histogram(aes_string(x = params$dependent_response_team), bins = 25) +
  facet_grid(.data[[params$dependent_response_DominateStrategy]] ~ Target) +
  labs(title = title_response_team, x = x_label_team, y = y_label_team) +
  ggsave(filename = plot_name)

# Information about the N values in each condition
tableData <- team_data %>%
  group_by(Target, .data[[params$dependent_response_DominateStrategy]]) %>%
  summarise(N = length(.data[[params$dependent_response_team]]))

tableData %>%
  kable() %>%
  kable_styling()
```

I see no obvious pattern.

```{r}
y_label_team <- "Count"
x_label_team <- params$dependent_response_name_WithSpace
setwd(figure_directory)

plot_data_team <- team_data %>%
  select(params$dependent_response_team, 
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder)

# Generate data by strategy
GA_plot_data_team <- plot_data_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

GT_plot_data_team <- plot_data_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Plot
 # GA
ggplot(data = GA_plot_data_team) + 
  geom_histogram(aes_string(x = params$dependent_response_team), bins = 30) +
  labs(title = paste("Distribution of", params$dependent_response_name_WithSpace, "(Team)","(", params$Strategy_GA_name_WithSpace ,")" ), x = x_label_team, y = y_label_team) +
  facet_grid( SessionOrder ~ Target) + 
  ggsave(filename = paste("Histogram_", params$dependent_response_name_NoSpace, "_ByTarget_BySessionOrder_", params$Strategy_GA_name_NoSpace, "_Team.png", sep = ""))

    # Information about the N values in each condition
GA_tableData <- GA_plot_data_team %>%
  select(params$dependent_response_team, Target, SessionOrder) %>%
  group_by(Target, SessionOrder) %>%
  summarise(N = length(.data[[params$dependent_response_team]]))

GA_tableData %>%
  kable(caption = paste("Data for ", params$Strategy_GA_name_WithSpace)) %>%
  kable_styling()

 # GT
ggplot(data = GT_plot_data_team) + 
  geom_histogram(aes_string(x = params$dependent_response_team), bins = 30) +
  labs(title = paste("Distribution of", params$dependent_response_name_WithSpace, "(Team)","(", params$Strategy_GT_name_WithSpace ,")" ), x = x_label_team, y = y_label_team) +
  facet_grid( SessionOrder ~ Target) + 
  ggsave(filename = paste("Histogram_", params$dependent_response_name_NoSpace, "_ByTarget_BySessionOrder_", params$Strategy_GT_name_NoSpace, "_Team.png", sep = ""))

    # Information about the N values in each condition
GT_tableData <- GT_plot_data_team %>%
  select(params$dependent_response_team, Target, SessionOrder) %>%
  group_by(Target, SessionOrder) %>%
  summarise(N = length(.data[[params$dependent_response_team]]))

GT_tableData %>%
  kable(caption = paste("Data for ", params$Strategy_GT_name_WithSpace)) %>%
  kable_styling()
```

No obvious patterns jump out at me. 

Go Alone: It does look like the distributions flatten over time in Ind_Team and Team condition

## Individual

```{r cache=FALSE}
y_label_ind <- "Count"
x_label_ind <- params$dependent_response_name_WithSpace
title_response_ind <- paste("Distribution of", params$dependent_response_name_WithSpace, "(Individual)")
plot_name <- paste("Histogram_", params$dependent_response_name_NoSpace, "_Ind.png", sep = "")
setwd(figure_directory)

plot_data_ind <- ind_data %>%
  select(params$dependent_response_ind, params$dependent_response_DominateStrategy, Target)

ggplot(data = plot_data_ind) + 
  geom_histogram(aes_string(x = params$dependent_response_ind), bins = 40) +
  facet_grid(. ~ .data[[params$dependent_response_DominateStrategy]]) + 
  labs(title = title_response_ind, x = x_label_ind, y = y_label_ind) +
  ggsave(filename = plot_name)
```

There seems to be a normal distribution when grouping the data by Strategy. 

```{r cache=FALSE}
y_label_ind <- "Count"
x_label_ind <- params$dependent_response_name_WithSpace
title_response_ind <- paste("Distribution of", params$dependent_response_name_WithSpace, "(Individual)")
plot_name <- paste("Histogram_", params$dependent_response_name_NoSpace, "_ByTarget_Ind.png", sep = "")
setwd(figure_directory)

plot_data_ind <- ind_data %>%
  select(params$dependent_response_ind, params$dependent_response_DominateStrategy, Target)

ggplot(data = plot_data_ind) + 
  geom_histogram(aes_string(x = params$dependent_response_ind), bins = 30) +
  facet_grid(.data[[params$dependent_response_DominateStrategy]] ~ Target) +
  labs(title = title_response_ind, x = x_label_ind, y = y_label_ind) +
  ggsave(filename = plot_name)

# Information about the N values in each condition
tableData <- ind_data %>%
  group_by(Target, .data[[params$dependent_response_DominateStrategy]]) %>%
  summarise(N = length(.data[[params$dependent_response_ind]]))

tableData %>%
  kable() %>%
  kable_styling()
```


No obvious pattern jumps out at me. There does seem to be a wide varience in the Go Together-Individual condition.

```{r}
y_label_ind <- "Count"
x_label_ind <- params$dependent_response_name_WithSpace
setwd(figure_directory)

plot_data_ind <- ind_data %>%
  select(params$dependent_response_ind, 
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder)

# Generate data by strategy
GA_plot_data_ind <- plot_data_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

GT_plot_data_ind <- plot_data_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# plot
  # GA
ggplot(data = GA_plot_data_ind) + 
  geom_histogram(aes_string(x = params$dependent_response_ind), bins = 30) +
  facet_grid(SessionOrder ~ Target) +
  labs(title = paste("Distribution of", params$dependent_response_name_WithSpace, "(Individual)","(", params$Strategy_GA_name_WithSpace ,")" ), x = x_label_ind, y = y_label_ind) +
  ggsave(filename = paste("Histogram_", params$dependent_response_name_NoSpace, "_ByTarget_BySessionOrder_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep = ""))

    # Information about the N values in each condition
GA_tableData <- GA_plot_data_ind %>%
  select(params$dependent_response_ind, Target, SessionOrder) %>%
  group_by(Target, SessionOrder) %>%
  summarise(N = length(.data[[params$dependent_response_ind]]))

GA_tableData %>%
  kable(caption =  paste("Data for ", params$Strategy_GA_name_WithSpace)) %>%
  kable_styling()

  # GT
ggplot(data = GT_plot_data_ind) + 
  geom_histogram(aes_string(x = params$dependent_response_ind), bins = 30) +
  facet_grid(SessionOrder ~ Target) +
  labs(title = paste("Distribution of", params$dependent_response_name_WithSpace, "(Individual)","(", params$Strategy_GT_name_WithSpace ,")" ), x = x_label_ind, y = y_label_ind) +
  ggsave(filename = paste("Histogram_", params$dependent_response_name_NoSpace, "_ByTarget_BySessionOrder_", params$Strategy_GT_name_NoSpace, "_Ind.png", sep = ""))

# Information about the N values in each condition
GT_tableData <- GT_plot_data_ind %>%
  select(params$dependent_response_ind, Target, SessionOrder) %>%
  group_by(Target, SessionOrder) %>%
  summarise(N = length(.data[[params$dependent_response_ind]]))

GT_tableData %>%
  kable(caption = paste("Data for ", params$Strategy_GT_name_WithSpace)) %>%
  kable_styling()
```

No obvious pattern. It is intersting to note that in Go Together, the Team conditions seems to noticably shift to the left. Indicating those teams needed less time to collect correct items. 

## Summary

Overall, there were no obvvious patterns worth noting. 

# Q: Is there an interaction between the Target and Session Order for the _`r params$dependent_response_name_WithSpace`_ that is statistically significant?

I am interested in determining if a linear mixed effect model should include the interaction effect between the Target and Session Order variable.

There are a few steps I will take. First, I will fit the multiple models using the data provided. Second, I will compare those models to the null model. Third, I will pick the models that are worth exploring further (e.g., models that are significantly different from the null model). Fourth, I will evaluate the effect size ($R^2$) of the fixed effect and random effect variables using a method by [@Nakagawa2013, @Johnson2014]. Lastly, I will analyze the assumptions for the residuals. 

A note on the effect size ($R^2$). This method generates two types of ($R^2$) values called marginal ($R_{m}^2$) and conditional ($R_{c}^2$) effect size. The $R_{m}^2$ calculates how much of the variance is described by the fixed effect variables (feedback condition and session order) while the $R_{c}^2$ calculates how much of the variance is described by both the fixed and random effect variables.

## Full Models Used for Team and Individual

The next two sections below describe the full model for team and individual level analysis. Five models were fitted and then compared. One model was the null model, one model was the full model, and the last three are a subset of the full model.

### Team Full Model

$$ y_{ijt} = \mu + \alpha_{i} + \beta_{j} + \alpha_{i} \beta_{j} + \gamma_{t} +   \epsilon_{ijt}$$ 

Where $y_{ijt}$ is the response variable (e.g., team score), $\mu$ is the baseline (or intercept), $\alpha_{i}$ is the fixed effect for the $i^{th}$ feedback target category, $\beta_{j}$ is the fixed effect for the $j^{th}$ session order, $\gamma_{t}$ is the random effect for the $t^{th}$ team, $ \alpha_{i} \beta_{j}$ is the fixed effect of the interaction between Target and Session Order, and $\epsilon_{ijt}$ is the residual for the model. 

### Individual Team Full Model

$$ y_{ijtp} = \mu + \alpha_{i} + \beta_{j} + \alpha_{i} \beta_{j} + \gamma_{t} + \theta_{p} + \epsilon_{ijtp}$$ 

Where $y_{ijtp}$ is the response variable (e.g., individual score), $\mu$ is the baseline (or intercept), $\alpha_{i}$ is the fixed effect for the $i^(th)$ feedback target category, $\beta_{j}$ is the fixed effect for the $j^(th)$ session order, $\gamma_{t}$ is the random effect for the $t^(th)$ team, $\theta_{p}$ is the random effect for the $p^(th)$ individual, $ \alpha_{i} \beta_{j}$ is the fixed effect of the interaction between Target and Session Order, and $\epsilon_{ijtp}$ is the residual for the model.

## Team

### GA

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.null <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "null", is.team = TRUE, is.robust =FALSE)
model.All <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "All", is.team = TRUE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoSession <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoSession", is.team = TRUE, is.robust = FALSE)

# There is an option to compare all the models with the anova(). However, the function does not compare all models to model.null
anova(model.null,
      model.All) %>%
  kable(caption = "ANOVA: Null and All") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: Null and No.Interaction") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: Null and No.Interaction.No.Target") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoSession) %>%
  kable(caption = "ANOVA: Null and No.Interaction.No.Session") %>%
  kable_styling()
```


The following models were significantly different from the null model: model.All,  model.NoInteraction, model.NoInteraction.NoTarget. 

model.All: Session Order, Target, and the interaction are included in this model.

model.NoInteraction: Session order and target are the fixed effects in this model.

model.NoInteraction.NoTarget: Session order is the only fixed effect in this model.

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.All <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "All", is.team = TRUE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

# Compare all of the models
anova(model.All,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: model.All and model.NoInteraction") %>%
  kable_styling()

anova(model.All,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: model.All and model.NoInteraction.NoTarget") %>%
  kable_styling()

anova(model.NoInteraction,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: model.NoInteraction and model.NoInteraction.NoTarget") %>%
  kable_styling()
```

model.All is not significantly different from the other models, suggesting that the interaction effect can be excluded from the model. model.NoInteraction us not significantly different from model.NoInteraction.NoTarget. However, AIC and BIC values are similar. I will look at the r squared values to compare the effect sizes. 

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

# Effect size (R^2)

r.squaredGLMM(model.NoInteraction.NoTarget) %>%
  kable(caption = "Table: Effect size for *No Interaction and No Target*") %>%
   kable_styling(full_width = F)

r.squaredGLMM(model.NoInteraction) %>%
  kable(caption = "Table: Effect size for *No Interaction*") %>%
   kable_styling(full_width = F)
```

Each model explains a similar amount of the varience. I wll analyze __model.NoInteraction.NoTarget__ and __model.NoInteraction__.

### GT

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.null <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "null", is.team = TRUE, is.robust =FALSE)
model.All <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "All", is.team = TRUE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoSession <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoSession", is.team = TRUE, is.robust = FALSE)

# There is an option to compare all the models with the anova(). However, the function does not compare all models to model.null
anova(model.null,
      model.All) %>%
  kable(caption = "ANOVA: Null and All") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: Null and No.Interaction") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: Null and No.Interaction.No.Target") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoSession) %>%
  kable(caption = "ANOVA: Null and No.Interaction.No.Session") %>%
  kable_styling()
```

The following models were significantly different from the null model: model.All,  model.NoInteraction, model.NoInteraction.NoTarget. 

model.All: Session Order, Target, and the interaction are included in this model.

model.NoInteraction: Session order and target are the fixed effects in this model.

model.NoInteraction.NoTarget: Session order is the only fixed effect in this model.

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.All <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "All", is.team = TRUE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

# Compare all of the models
anova(model.All,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: model.All and model.NoInteraction") %>%
  kable_styling()

anova(model.All,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: model.All and model.NoInteraction.NoTarget") %>%
  kable_styling()

anova(model.NoInteraction,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: model.NoInteraction and model.NoInteraction.NoTarget") %>%
  kable_styling()
```

model.All is not significantly different from the other models, suggesting that the interaction effect can be excluded from the model. model.NoInteraction is not significantly different from model.NoInteraction.NoTarget. It is important to note that the difference between the models is margnially significant. However, AIC and BIC values are similar. I will look at the r squared values to compare the effect sizes. 

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

# Effect size (R^2)

r.squaredGLMM(model.NoInteraction.NoTarget) %>%
  kable(caption = "Table: Effect size for *No Interaction and No Target*") %>%
   kable_styling(full_width = F)

r.squaredGLMM(model.NoInteraction) %>%
  kable(caption = "Table: Effect size for *No Interaction*") %>%
   kable_styling(full_width = F)
```

Each model explains a similar amount of the varience. I wll analyze __model.NoInteraction.NoTarget__ and __model.NoInteraction__.

## Individual

### GA

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.null <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "null", is.team = FALSE, is.robust = FALSE)
model.All <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "All", is.team = FALSE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)
model.NoInteraction.NoSession <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoSession", is.team = FALSE, is.robust = FALSE)

# There is an option to compare all the models with the anova(). However, the function does not compare all models to model.null
anova(model.null,
      model.All) %>%
  kable(caption = "ANOVA: model.null and model.All") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: model.null and model.NoInteraction") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: model.null and model.NoInteraction.NoTarget") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoSession) %>%
  kable(caption = "ANOVA: model.null and model.NoInteraction.NoSession") %>%
  kable_styling()
```

The following models were significantly different from the null model: model.All,  model.NoInteraction, model.NoInteraction.NoTarget. 

model.All: Session Order, Target, and the interaction are included in this model.

model.NoInteraction: Session order and target are the fixed effects in this model.

model.NoInteraction.NoTarget: Session order is the only fixed effect in this model.


```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.All <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "All", is.team = FALSE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

anova(model.All,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: All and No.Interaction") %>%
  kable_styling()

anova(model.All,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: All and NoInteraction.NoTarget") %>%
  kable_styling()

anova(model.NoInteraction,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: No.Interaction and NoInteraction.NoTarget") %>%
  kable_styling()
```

model.All is not significantly different from the other models, suggesting that the interaction effect can be excluded from the model. model.NoInteraction is not significantly different from model.NoInteraction.NoTarget. It is important to note that the difference between the models is margnially significant. However, AIC and BIC values are similar. I will look at the r squared values to compare the effect sizes. 

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

# Effect size (R^2)

r.squaredGLMM(model.NoInteraction) %>%
  kable(caption = "Table: Effect size for *No Interaction*") %>%
   kable_styling(full_width = F)

r.squaredGLMM(model.NoInteraction.NoTarget) %>%
  kable(caption = "Table: Effect size for *No Interaction No Target*") %>%
   kable_styling(full_width = F)
```

Each model explains a similar amount of the varience. I wll analyze __model.NoInteraction.NoTarget__ and __model.NoInteraction__. 

### GT

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.null <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "null", is.team = FALSE, is.robust = FALSE)
model.All <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "All", is.team = FALSE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)
model.NoInteraction.NoSession <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoSession", is.team = FALSE, is.robust = FALSE)

# There is an option to compare all the models with the anova(). However, the function does not compare all models to model.null
anova(model.null,
      model.All) %>%
  kable(caption = "ANOVA: model.null and model.All") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: model.null and model.NoInteraction") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: model.null and model.NoInteraction.NoTarget") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoSession) %>%
  kable(caption = "ANOVA: model.null and model.NoInteraction.NoSession") %>%
  kable_styling()
```

All of the models were significantly different from the null model: model.All,  model.NoInteraction, model.NoInteraction.NoTarget. 

model.All: Session Order, Target, and the interaction are included in this model.

model.NoInteraction: Session order and target are the fixed effects in this model.

model.NoInteraction.NoTarget: Session order is the only fixed effect in this model.

model.NoInteraction.NoSession: Target is the only fixed effect in this model. 

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.All <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "All", is.team = FALSE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)
model.NoInteraction.NoSession <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoSession", is.team = FALSE, is.robust = FALSE)

anova(model.All,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: All and No.Interaction") %>%
  kable_styling()

anova(model.All,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: All and NoInteraction.NoTarget") %>%
  kable_styling()
anova(model.All,
      model.NoInteraction.NoSession) %>%
  kable(caption = "ANOVA: All and model.NoInteraction.NoSession") %>%
  kable_styling()

anova(model.NoInteraction,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: No.Interaction and NoInteraction.NoTarget") %>%
  kable_styling()

anova(model.NoInteraction,
      model.NoInteraction.NoSession) %>%
  kable(caption = "ANOVA: No.Interaction and model.NoInteraction.NoSession") %>%
  kable_styling()

anova(model.NoInteraction.NoTarget,
      model.NoInteraction.NoSession) %>%
  kable(caption = "ANOVA: model.NoInteraction.NoTarget and model.NoInteraction.NoSession") %>%
  kable_styling()
```

model.All was only signficantly better than model.NoInteraction.NoSession. Since model.All was not significantly better than model.NoInteraction and model.NoInteraction.Target, I will remove the interaction effect from the model. model.NoInteraction is significantly different from model.NoInteraction.NoTarget and model.NoInteraction.NoSession. However, the AIC and BIC values for model.NoInteraction and model.NoInteraction.NoTarget are similar. I will examine the r sqaured values.


```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

# Effect size (R^2)

r.squaredGLMM(model.NoInteraction) %>%
  kable(caption = "Table: Effect size for *model.NoInteraction*") %>%
   kable_styling(full_width = F)

r.squaredGLMM(model.NoInteraction.NoTarget) %>%
  kable(caption = "Table: Effect size for *model.NoInteraction.NoTarget*") %>%
   kable_styling(full_width = F)
```

Each model explains a similar amount of the varience. I wll analyze __model.NoInteraction.NoTarget__ and __model.NoInteraction__.

## Summary

Overall, __model.NoInteraction.NoTarget__ and __model.NoInteraction__ describe the data the best at the individual and team level. model.NoInteraction was only significantly different from __model.NoInteraction.NoTarget__ at the individual level for teams using the Go Together. 

# Q: Do the models satisfy the assumptions?

The purpose of this question is to see what we can learn from these models. Before I examine the model by generating diagnostic plots for the models. The assumptions are as follows [@Galwey2014]:

1. The residuals should have an approximately normal distribution (i.e., a bell curve) when plotted on a histogram.
2. A fitted-value plot should show an almost constant width when viewed from left to right.
3. The points on a normal plot should lie on an almost straight line from the bottom left to the top right.

The models may violate some of the assumptions. According to @Field2017, the best way to examine the influence of assumption violations is to compare a robust model to a standard model. When models violate assumptions, I will compare a robust model to a classic model. If there is a noticeable difference between the two models (i.e., if the estimated coefficient are noticeably different) then I will use a step on the power ladder to transform (@Tukey1977), or re-express, the data to address the assumption violation.

## Team

### model.NoInteraction

#### GA

```{r}
# Plot location
setwd(figure_directory)

# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Team.png", sep = ""))

# Fitted values - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("FitteValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Team.png", sep = ""))

# QQ plots - model.NoInteraction
ggplot(model.NoInteraction, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for NoInteraction", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Team.png", sep = ""))
```

It looks like there may be a violation with assumption 2 and a slight violation of assumption 3.

#### GT

```{r}
# Plot location
setwd(figure_directory)

# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace, "_Team.png", sep = ""))

# Fitted values - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("FitteValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace, "_Team.png", sep = ""))

# QQ plots - model.NoInteraction
ggplot(model.NoInteraction, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for NoInteraction", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace, "_Team.png", sep = ""))
```

There may be a violation of assumption 1. 

### model.NoInteraction.NoTarget

#### GA

```{r}
# Plot location
setwd(figure_directory)

# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction.NoTarget"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Team.png", sep = ""))

# Fitted values - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction.NoTarget"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("FitteValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Team.png", sep = ""))

# QQ plots - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for model.NoInteraction.NoTarget", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Team.png", sep = ""))
```

There seems to be a violation of asumption 3.

#### GT

```{r}
# Plot location
setwd(figure_directory)

# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction.NoTarget"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace, "_Team.png", sep = ""))

# Fitted values - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction.NoTarget"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("FitteValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace, "_Team.png", sep = ""))

# QQ plots - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for model.NoInteraction.NoTarget", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace, "_Team.png", sep = ""))
```

Generally there seems to be no violtation, but I will still compare the reobust model to the classic model because of the tail end on the far right. 

## Individual

### model.NoInteraction

#### GA

```{r}
# Plot location
setwd(figure_directory)

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))

# Fitted values - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("FittedValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))


# QQ plots - model.NoInteraction
ggplot(model.NoInteraction, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for model.NoInteraction", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))
```

There seems to be a violation of assumption 2 and 3.

#### GT

```{r}
# Plot location
setwd(figure_directory)

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace , "Ind.png", sep =""))

# Fitted values - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("FittedValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace , "Ind.png", sep =""))


# QQ plots - model.NoInteraction
ggplot(model.NoInteraction, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for model.NoInteraction", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace , "Ind.png", sep =""))
```

There seems to be a violation with assumption 3.

### model.NoInteraction.NoTarget

#### GA

```{r}
# Plot location
setwd(figure_directory)

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction.NoTarget"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))

# Fitted values - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction.NoTarget"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("FittedValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))


# QQ plots - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for model.NoInteraction.NoTarget", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))
```

There seems to be a violation of assumption 2 and 3.

#### GT

```{r}
# Plot location
setwd(figure_directory)

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction.NoTarget"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))

# Fitted values - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction.NoTarget"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("FittedValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))


# QQ plots - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for model.NoInteraction.NoTarget", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))
```

There seems to be a vilotation to assumption 3. 

## Summary

Overall, each model at each strategy seems to violate the assumption. I will need to compare the robust model for all of them. 

# Q: Does the violation influence the linear model estimation?

## Team

### model.NoInteraction

#### GA

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
rmodel.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction, rmodel.NoInteraction, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction") %>%
  kable_styling()
```

I see no concerable difference. I will not transform data. 

#### GT

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
rmodel.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction, rmodel.NoInteraction, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction") %>%
  kable_styling()
```

I see no concernable difference. I will not transform data. 

### model.NoInteraction.NoTarget

#### GA

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)
rmodel.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction.NoTarget, rmodel.NoInteraction.NoTarget, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction.NoTarget") %>%
  kable_styling()
```

I see no concernable difference. I will not transform data.

#### GT

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)
rmodel.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction.NoTarget, rmodel.NoInteraction.NoTarget, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction.NoTarget") %>%
  kable_styling()
```

I see no concerable difference. I will not transform. 

## Individual

### model.NoInteraction

#### GA

```{r}
#response_variable <- "II_ind"

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)
rmodel.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction, rmodel.NoInteraction, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction") %>%
  kable_styling()
```

I see no concerable difference. I will not transform. 

#### GT

```{r}
#response_variable <- "II_ind"

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)
rmodel.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction, rmodel.NoInteraction, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction") %>%
  kable_styling()
```

I see no concernable difference. I will not transform the data. 

### model.NoInteraction.NoTarget

#### GA

```{r}
#response_variable <- "II_ind"

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)
rmodel.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction.NoTarget, rmodel.NoInteraction.NoTarget, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction.NoTarget") %>%
  kable_styling()
```

I see no concernable difference. I will not transform the data. 

#### GT

```{r}
#response_variable <- "II_ind"

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)
rmodel.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction.NoTarget, rmodel.NoInteraction.NoTarget, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction.NoTarget") %>%
  kable_styling()
```

I see no concerable difference. I will not transform the data

## Summary

Overall, the visual assumption violations did not not seem to influence the model for any of the models. I will not transform the data for any of the models.

# Q: Are there any effects that are significant?

## Team

### model.NoInteraction

#### GA

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

summary(model.NoInteraction)
```

The results show a significant effect from Ind_Team condition in reference to the Ind condition. The results show a significant effect from session 4 in reference to the session 2.

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ Target), adjust = "tukey")
```

The results show no significant difference among the conditions. 

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ SessionOrder), adjust = "tukey")
```

The results show a significant diference between session 2 and 4 and betweent 3 and 4.

#### GT

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

summary(model.NoInteraction)
```

The results show a significant effect from Team condition in reference to Ind. The results show a significant effect from session 3 and 4, in reference to session 2.

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ Target), adjust = "tukey")
```

The results show no significant difference among the conditions.

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ SessionOrder), adjust = "tukey")
```

There is a significant difference between session 2 and 3, and between session 2 and 4.

### model.NoInteraction.NoTarget

#### GA

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

summary(model.NoInteraction.NoTarget)
```

The results show a significant effect from session 4 in reference to session 2. 

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

emmeans(model.NoInteraction.NoTarget, list(pairwise ~ SessionOrder), adjust = "tukey")
```

The results show a significant difference between session 2 and 4, and between session 3 and 4.

#### GT

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

summary(model.NoInteraction.NoTarget)
```

The results show a significant effect from session 3 and 4, in reference to session 2. 

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

emmeans(model.NoInteraction.NoTarget, list(pairwise ~ SessionOrder), adjust = "tukey")
```

The results show a significant effect difference between session 2 and 3, and between 2 and 4.

## Individual 

### model.NoInteraction

#### GA

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

summary(model.NoInteraction)
```

The results show a significant effect from Ind_Team in reference to Ind. There is a significant effect from session 4 in reference to session 2. There is a marginally significant effect from session 3 in reference to session 2. 

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ Target), adjust = "tukey")
```

The resulst show a __marginally significant__ difference between Ind and Ind_Team. Indicating that more data is needed to reach a significant result. If the difference is significant, the results indicate that the correct item collection rate is lower in Ind condition. 

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ SessionOrder), adjust = "tukey")
```

The results show a significant difference between session 2 and 4, and betwee session 3 and 4. 

#### GT

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

summary(model.NoInteraction)
```

The results show a significant effect from Team condition in reference to Ind condition. The result show a signifcant effect from session 3 and 4.

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ Target), adjust = "tukey")
```

The results show a __significant difference__ between Ind and Team condition. The significant results indictate that the collection rate in the Team condition is lower than the Ind condition. 

The results also show a __marginally significant__ difference between Ind_Team and Team condition, indicating that more data is need to reach significance. The marginally significant result indicates that the collection rate for correct items was lower in the Team condition.

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ SessionOrder), adjust = "tukey")
```

The results show a significant difference among each session order. 

### model.NoInteraction.NoTarget

#### GA

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

summary(model.NoInteraction.NoTarget)
```

The results show a significant effect from session 4 in reference to session 2.

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

emmeans(model.NoInteraction.NoTarget, list(pairwise ~ SessionOrder), adjust = "tukey")
```

The results show a signifcant difference between session 2 and 4, and between session 3 and 4.

#### GT

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

summary(model.NoInteraction.NoTarget)
```

The results indicate a significant effect from session 3 and 4, in reference to session 2.

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

emmeans(model.NoInteraction.NoTarget, list(pairwise ~ SessionOrder), adjust = "tukey")
```

The results show a significany difference among every session. 

## Summary

Overall, there were __significant__ and __margnially significant__ results at the individual level.

For teams that use GA, in model.NoInteraction, there was a __marginally significant__ difference (estimated marginal means) between the Ind and Ind_Team condition. If the difference eventually reaches significance, the difference indicates that the collection rate is lower in the Ind condition. The difference suggests that giving Ind feedback to teams that used the GA reduced the amount of individual time needed to collect correct items when compared to Ind_Team feedback. This makes sense because if teams are using GA, then they are on their own and may only be concerned with their own performance. 

For teams that use GA, in model.NoInteraction, there was a __significant difference__ between Ind and Team condition. Specifically, the results indicate that the collection rate in the Team condition lower than the Ind condition. The results suggest that the time needed for individuals to collect correct items is reduced when given team feedback, when compared to Ind feedback. This makes sense because teams using GT are going together as a team. There was also a __marginally significant__ difference between Ind_Team and Team condition. No meaningful conclusion can be drawn from this result because the null hypothesis was not rejected. However, if the difference reaches significance, then the difference suggests that collection rate for correct items was lower in the Team condition when compared to Ind_Team. The difference suggests that individual collection rates for teams using GT is reduced when given Team feedback, when compared to Ind_Team.

### Summary - Short hand

Ind > no interaction > GA
"The resulst show a __marginally significant__ difference between Ind and Ind_Team. Indicating that more data is needed to reach a significant result. If the difference is significant, the results indicate that the correct item collection rate is lower in Ind condition. "

Ind > No Interaction > GT
"The results show a __significant difference__ between Ind and Team condition. The significant results indictate that the collection rate in the Team condition is lower than the Ind condition. 

The results also show a __marginally significant__ difference between Ind_Team and Team condition, indicating that more data is need to reach significance. The marginally significant result indicates that the collection rate for correct items was lower in the Team condition"


















# References