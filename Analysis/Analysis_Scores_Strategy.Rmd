---
title: 'Dissertation Analysis: Scores - Strategy'
author: "Jamiahus Walton"
date: "`r Sys.Date()`"
output: 
  html_document: 
    toc: true
editor_options:
  chunk_output_type: inline
csl: apa.csl
bibliography: bibliography.bib
params:
  dependent_response_name_WithSpace: "Score"
  dependent_response_name_NoSpace: "Score"
  dependent_response_team: "TeamScore"
  dependent_response_ind: "IndividualScore"
  dependent_response_DominateStrategy: "Dominate.Strategy"
  Strategy_GT_name_NoSpace: "Go.Together"
  Strategy_GT_name_WithSpace: "Go Together"
  Strategy_GA_name_NoSpace: "Go.Alone"
  Strategy_GA_name_WithSpace: "Go Alone"
---

```{r setup, include=FALSE, cache=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Tips for formatting in RMarkdown
# Link: https://monashbioinformaticsplatform.github.io/2017-11-16-open-science-training/topics/rmarkdown.html

# Equations
# Link: https://www.calvin.edu/~rpruim/courses/s341/S17/from-class/MathinRmd.html

# Create awesome HTML table with knitr::kableand kableExtra
# LinkL https://haozhu233.github.io/kableExtra/awesome_table_in_html.html

# Examples of how to use the ggrepel package
# Link: https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html#examples

# Packages for data analysis
library(tidyverse)
library(lme4)
library(lmerTest)
library(emmeans)
library(svMisc)
library(MuMIn)
library(modelr)
library(sjstats)
library(robustlmm)
library(ggrepel)
library(knitr)
library(kableExtra)

# Functions used in documents ----
remove_measures_with_given_value <- function(data_set, col_name, value){
  rows_to_move <- which(as.vector(data_set[,col_name]) == value) 
  
  return(data_set[-rows_to_move,])
}

# Factor columns that need it.
re_factor_columns <- function(userData, columnNames){
  factorData <- userData
  for(column in columnNames){
    print(column)
    factorData[,column] <- factor(factorData[,column])
  }
  return(factorData)
}

# Model the data for the team level analysis ----
model_data_Target_Session <- function(df, dependent, model.type, is.team, is.robust){
  
  if(is.team){
    if(model.type == "null" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ 1 + (1|Team)")))
    } else if(model.type == "All"){
      lmer(data = df, as.formula(paste(dependent,"~ Target * SessionOrder + (1|Team)")))
    } else if(model.type == "NoInteraction" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ Target + SessionOrder + (1|Team)")))
    } else if(model.type == "NoInteraction_NoTarget" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ SessionOrder + (1|Team)")))
    } else if(model.type == "NoInteraction_NoSession" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ Target + (1|Team)")))
    } else if(model.type == "null" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ 1 + (1|Team)")))
    } else if(model.type == "All" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ Target * SessionOrder + (1|Team)")))
    } else if(model.type == "NoInteraction" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ Target + SessionOrder + (1|Team)")))
    } else if(model.type == "NoInteraction_NoTarget" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ SessionOrder + (1|Team)")))
    } else if(model.type == "NoInteraction_NoSession" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ Target + (1|Team)")))
    } else{
      stop("Model.type not supported")
    }
  } else {
    # Run this code if individual level model
    if(model.type == "null" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ 1 + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "All" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ Target * SessionOrder + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "NoInteraction" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ Target + SessionOrder + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "NoInteraction_NoTarget" && !is.robust){
      lmer(data = df, as.formula(paste(dependent,"~ SessionOrder + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "NoInteraction_NoSession"){
      lmer(data = df, as.formula(paste(dependent,"~ Target + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "null" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ 1 + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "All" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ Target * SessionOrder + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "NoInteraction" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ Target + SessionOrder + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "NoInteraction_NoTarget" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ SessionOrder + (1|Team) + (1| Player_ID)")))
    } else if(model.type == "NoInteraction_NoSession" && is.robust){
      rlmer(data = df, as.formula(paste(dependent,"~ Target + (1|Team) + (1| Player_ID)")))
    } else{
      stop("Model.type not supported")
    }
  }
}

#Folder locations ----
figure_directory <- "C:\\Users\\jamia\\Box\\TMET2\\DATA TMET2\\Data_And_Calcuations\\Figures"
main_work_directory_name <- "C:\\Users\\jamia\\Box\\TMET2\\DATA TMET2\\Data_And_Calcuations\\Raw Data\\"

database_folder_name <- "Database"
file_name_output <- "team_player_aggragate_stats.csv"
folder_location_database <- paste(main_work_directory_name, database_folder_name, sep = "")
aggregate_folder_location <- paste(folder_location_database,"\\", file_name_output, sep = "") #This will combine the final file name and the desiered folder location

# Read aggregaate data ----
my_aggregate_data <- read.csv(file =  aggregate_folder_location)

clean_aggregate_data_stats <- remove_measures_with_given_value(data_set =  my_aggregate_data, col_name = "Condition", value = "A") # without none condition

# Re factor the columns
columns_to_refactor <- c("SessionOrder", 
                         "Team", 
                         "Player_ID", 
                         "Condition", 
                         "Dominate.Strategy", 
                         "Condition", 
                         "Target",
                         "Confident_team_comm_important_details_quickly")
clean_aggregate_data_stats <- re_factor_columns(clean_aggregate_data_stats, columns_to_refactor)

# What is the N for Teams ----
N_teams <- length(levels(factor(clean_aggregate_data_stats$Team)))

# What is the N for Inds ----
N_ind <- length(levels(factor(clean_aggregate_data_stats$Player_ID) ))

# Team data set ----
team_data <- clean_aggregate_data_stats %>%
  filter(Player == 1)

# Individual data set ----
ind_data <- clean_aggregate_data_stats

```

# Q: Is there exciting variation among the _`r params$dependent_response_name_WithSpace`_ metric that will help me understand the influence of the feedback condition?


## Team

```{r cache=FALSE}
y_label_team <- "Count"
x_label_team <- params$dependent_response_name_WithSpace
title_response_team <- paste("Distribution of", params$dependent_response_name_WithSpace, "(Team)")
plot_name <- paste("Histogram_", params$dependent_response_name_NoSpace, "_Team.png", sep = "")
setwd(figure_directory)

plot_data_team <- team_data %>%
  select(params$dependent_response_team, 
         params$dependent_response_DominateStrategy, 
         Target)

ggplot(data = plot_data_team) + 
  geom_histogram(aes_string(x = params$dependent_response_team), bins = 30) +
  facet_grid( . ~ .data[[params$dependent_response_DominateStrategy]]) +
  labs(title = title_response_team, x = x_label_team, y = y_label_team) +
  ggsave(filename = plot_name)
```

The distribution of the scores using the `r params$Strategy_GA_name_WithSpace` is skewed to the left with a center around 55 or so and the distribution of the score using the  `r params$Strategy_GT_name_WithSpace` is normally distributed with the cetner around 65. 

```{r cache=FALSE}
y_label_team <- "Count"
x_label_team <- "Target"
title_response_team <- paste("Distribution of", params$dependent_response_name_WithSpace, "(Team)")
plot_name <- paste("Histogram_", params$dependent_response_name_NoSpace, "_ByTarget_Team.png", sep = "")
setwd(figure_directory)

plot_data_team <- team_data %>%
  select(params$dependent_response_team, 
         params$dependent_response_DominateStrategy, 
         Target)

ggplot(data = plot_data_team) + 
  geom_histogram(aes_string(x = params$dependent_response_team), bins = 25) +
  facet_grid(.data[[params$dependent_response_DominateStrategy]] ~ Target) +
  labs(title = title_response_team, x = x_label_team, y = y_label_team) +
  ggsave(filename = plot_name)

# Information about the N values in each condition
tableData <- team_data %>%
  group_by(Target, .data[[params$dependent_response_DominateStrategy]]) %>%
  summarise(N = length(.data[[params$dependent_response_team]]))

tableData %>%
  kable() %>%
  kable_styling()
```

The `r params$Strategy_GA_name_WithSpace` teams appear to have a skew to the left, similar to the overall distribution. The `r params$Strategy_GT_name_WithSpace` teams distribution is flatter compared to the overall distribution.

```{r}
y_label_team <- "Count"
x_label_team <- params$dependent_response_name_WithSpace
setwd(figure_directory)

plot_data_team <- team_data %>%
  select(params$dependent_response_team, 
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder)

# Generate data by strategy
GA_plot_data_team <- plot_data_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

GT_plot_data_team <- plot_data_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Plot
 # GA
ggplot(data = GA_plot_data_team) + 
  geom_histogram(aes_string(x = params$dependent_response_team), bins = 30) +
  labs(title = paste("Distribution of", params$dependent_response_name_WithSpace, "(Team)","(", params$Strategy_GA_name_WithSpace ,")" ), x = x_label_team, y = y_label_team) +
  facet_grid( SessionOrder ~ Target) + 
  ggsave(filename = paste("Histogram_", params$dependent_response_name_NoSpace, "_ByTarget_BySessionOrder_", params$Strategy_GA_name_NoSpace, "_Team.png", sep = ""))

    # Information about the N values in each condition
GA_tableData <- GA_plot_data_team %>%
  select(params$dependent_response_team, Target, SessionOrder) %>%
  group_by(Target, SessionOrder) %>%
  summarise(N = length(.data[[params$dependent_response_team]]))

GA_tableData %>%
  kable(caption = paste("Data for ", params$Strategy_GA_name_WithSpace)) %>%
  kable_styling()

 # GT
ggplot(data = GT_plot_data_team) + 
  geom_histogram(aes_string(x = params$dependent_response_team), bins = 30) +
  labs(title = paste("Distribution of", params$dependent_response_name_WithSpace, "(Team)","(", params$Strategy_GT_name_WithSpace ,")" ), x = x_label_team, y = y_label_team) +
  facet_grid( SessionOrder ~ Target) + 
  ggsave(filename = paste("Histogram_", params$dependent_response_name_NoSpace, "_ByTarget_BySessionOrder_", params$Strategy_GT_name_NoSpace, "_Team.png", sep = ""))

    # Information about the N values in each condition
GT_tableData <- GT_plot_data_team %>%
  select(params$dependent_response_team, Target, SessionOrder) %>%
  group_by(Target, SessionOrder) %>%
  summarise(N = length(.data[[params$dependent_response_team]]))

GT_tableData %>%
  kable(caption = paste("Data for ", params$Strategy_GT_name_WithSpace)) %>%
  kable_styling()
```

In the `r params$Strategy_GA_name_WithSpace`, the distributions starts out as normal but then flattens over time. In the `r params$Strategy_GT_name_WithSpace`, the distributions seems to be flat over time but shift to the right over time as well.

## Individual

```{r cache=FALSE}
y_label_ind <- "Count"
x_label_ind <- params$dependent_response_name_WithSpace
title_response_ind <- paste("Distribution of", params$dependent_response_name_WithSpace, "(Individual)")
plot_name <- paste("Histogram_", params$dependent_response_name_NoSpace, "_Ind.png", sep = "")
setwd(figure_directory)

plot_data_ind <- ind_data %>%
  select(params$dependent_response_ind, params$dependent_response_DominateStrategy, Target)

ggplot(data = plot_data_ind) + 
  geom_histogram(aes_string(x = params$dependent_response_ind), bins = 40) +
  facet_grid(. ~ .data[[params$dependent_response_DominateStrategy]]) + 
  labs(title = title_response_ind, x = x_label_ind, y = y_label_ind) +
  ggsave(filename = plot_name)
```

The distribution in the both groups seem to be normally distributed. However, the center in the `r params$Strategy_GA_name_WithSpace` is around ~61 and the the center in the `r params$Strategy_GT_name_WithSpace` is around ~68, indicating the individual scores are higher in the `r params$Strategy_GT_name_WithSpace`. 

```{r cache=FALSE}
y_label_ind <- "Count"
x_label_ind <- params$dependent_response_name_WithSpace
title_response_ind <- paste("Distribution of", params$dependent_response_name_WithSpace, "(Individual)")
plot_name <- paste("Histogram_", params$dependent_response_name_NoSpace, "_ByTarget_Ind.png", sep = "")
setwd(figure_directory)

plot_data_ind <- ind_data %>%
  select(params$dependent_response_ind, params$dependent_response_DominateStrategy, Target)

ggplot(data = plot_data_ind) + 
  geom_histogram(aes_string(x = params$dependent_response_ind), bins = 30) +
  facet_grid(.data[[params$dependent_response_DominateStrategy]] ~ Target) +
  labs(title = title_response_ind, x = x_label_ind, y = y_label_ind) +
  ggsave(filename = plot_name)

# Information about the N values in each condition
tableData <- ind_data %>%
  group_by(Target, .data[[params$dependent_response_DominateStrategy]]) %>%
  summarise(N = length(.data[[params$dependent_response_ind]]))

tableData %>%
  kable() %>%
  kable_styling()
```

In both the `r params$Strategy_GA_name_WithSpace` group and the `r params$Strategy_GT_name_WithSpace`, the distribution appears to be similar to their repsective overall distribution.

```{r}
y_label_ind <- "Count"
x_label_ind <- params$dependent_response_name_WithSpace
setwd(figure_directory)

plot_data_ind <- ind_data %>%
  select(params$dependent_response_ind, 
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder)

# Generate data by strategy
GA_plot_data_ind <- plot_data_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

GT_plot_data_ind <- plot_data_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# plot
  # GA
ggplot(data = GA_plot_data_ind) + 
  geom_histogram(aes_string(x = params$dependent_response_ind), bins = 30) +
  facet_grid(SessionOrder ~ Target) +
  labs(title = paste("Distribution of", params$dependent_response_name_WithSpace, "(Individual)","(", params$Strategy_GA_name_WithSpace ,")" ), x = x_label_ind, y = y_label_ind) +
  ggsave(filename = paste("Histogram_", params$dependent_response_name_NoSpace, "_ByTarget_BySessionOrder_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep = ""))

    # Information about the N values in each condition
GA_tableData <- GA_plot_data_ind %>%
  select(params$dependent_response_ind, Target, SessionOrder) %>%
  group_by(Target, SessionOrder) %>%
  summarise(N = length(.data[[params$dependent_response_ind]]))

GA_tableData %>%
  kable(caption =  paste("Data for ", params$Strategy_GA_name_WithSpace)) %>%
  kable_styling()

  # GT
ggplot(data = GT_plot_data_ind) + 
  geom_histogram(aes_string(x = params$dependent_response_ind), bins = 30) +
  facet_grid(SessionOrder ~ Target) +
  labs(title = paste("Distribution of", params$dependent_response_name_WithSpace, "(Individual)","(", params$Strategy_GT_name_WithSpace ,")" ), x = x_label_ind, y = y_label_ind) +
  ggsave(filename = paste("Histogram_", params$dependent_response_name_NoSpace, "_ByTarget_BySessionOrder_", params$Strategy_GT_name_NoSpace, "_Ind.png", sep = ""))

# Information about the N values in each condition
GT_tableData <- GT_plot_data_ind %>%
  select(params$dependent_response_ind, Target, SessionOrder) %>%
  group_by(Target, SessionOrder) %>%
  summarise(N = length(.data[[params$dependent_response_ind]]))

GT_tableData %>%
  kable(caption = paste("Data for ", params$Strategy_GT_name_WithSpace)) %>%
  kable_styling()
```

In the `r params$Strategy_GA_name_WithSpace` group, the distribution of the scores flatten over time. 

In the `r params$Strategy_GT_name_WithSpace`, the distribution of the scores in the Ind and Ind_Team condition flatten over time. In the Team condition, the scores seem to skew to the right over time.


## Summary

At the team level, the overall distributions for the `r params$Strategy_GA_name_WithSpace` and the `r params$Strategy_GT_name_WithSpace` are different. The `r params$Strategy_GA_name_WithSpace` group has a distrbition that has a slight skew to the left and centered around 55 or so. The `r params$Strategy_GT_name_WithSpace` has a normal distribution with a center around 65. This is indicates that generally, teams using the `r params$Strategy_GT_name_WithSpace` socre higher than teams that use `r params$Strategy_GA_name_WithSpace`. 

At the individual level, both group (i.e., `r params$Strategy_GA_name_WithSpace` and `r params$Strategy_GT_name_WithSpace`) have a normal distribution. However, the center in the `r params$Strategy_GA_name_WithSpace` is around ~61 and the the center in the `r params$Strategy_GT_name_WithSpace` is around ~68, indicating the individual scores are higher in the `r params$Strategy_GT_name_WithSpace`. Something interesting to note, in session 4 for the teams that use `r params$Strategy_GA_name_WithSpace`, the distribution is skewed to the right.

Overall, it seems as though there is something interesting occuring when grouping the data by strategy. 


# Q: Is there an interaction between the Target and Session Order for the _`r params$dependent_response_name_WithSpace`_ that is statistically significant?

I am interested in determining if a linear mixed effect model should include the interaction effect between the Target and Session Order variable.

There are a few steps I will take. First, I will fit the multiple models using the data provided. Second, I will compare those models to the null model. Third, I will pick the models that are worth exploring further (e.g., models that are significantly different from the null model). Fourth, I will evaluate the effect size ($R^2$) of the fixed effect and random effect variables using a method by [@Nakagawa2013, @Johnson2014]. Lastly, I will analyze the assumptions for the residuals. 

A note on the effect size ($R^2$). This method generates two types of ($R^2$) values called marginal ($R_{m}^2$) and conditional ($R_{c}^2$) effect size. The $R_{m}^2$ calculates how much of the variance is described by the fixed effect variables (feedback condition and session order) while the $R_{c}^2$ calculates how much of the variance is described by both the fixed and random effect variables.

## Full Models Used for Team and Individual

The next two sections below describe the full model for team and individual level analysis. Five models were fitted and then compared. One model was the null model, one model was the full model, and the last three are a subset of the full model.

### Team Full Model

$$ y_{ijt} = \mu + \alpha_{i} + \beta_{j} + \alpha_{i} \beta_{j} + \gamma_{t} +   \epsilon_{ijt}$$ 

Where $y_{ijt}$ is the response variable (e.g., team score), $\mu$ is the baseline (or intercept), $\alpha_{i}$ is the fixed effect for the $i^{th}$ feedback target category, $\beta_{j}$ is the fixed effect for the $j^{th}$ session order, $\gamma_{t}$ is the random effect for the $t^{th}$ team, $ \alpha_{i} \beta_{j}$ is the fixed effect of the interaction between Target and Session Order, and $\epsilon_{ijt}$ is the residual for the model. 

### Individual Team Full Model

$$ y_{ijtp} = \mu + \alpha_{i} + \beta_{j} + \alpha_{i} \beta_{j} + \gamma_{t} + \theta_{p} + \epsilon_{ijtp}$$ 

Where $y_{ijtp}$ is the response variable (e.g., individual score), $\mu$ is the baseline (or intercept), $\alpha_{i}$ is the fixed effect for the $i^(th)$ feedback target category, $\beta_{j}$ is the fixed effect for the $j^(th)$ session order, $\gamma_{t}$ is the random effect for the $t^(th)$ team, $\theta_{p}$ is the random effect for the $p^(th)$ individual, $ \alpha_{i} \beta_{j}$ is the fixed effect of the interaction between Target and Session Order, and $\epsilon_{ijtp}$ is the residual for the model.

## Team

### GA

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.null <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "null", is.team = TRUE, is.robust =FALSE)
model.All <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "All", is.team = TRUE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoSession <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoSession", is.team = TRUE, is.robust = FALSE)

# There is an option to compare all the models with the anova(). However, the function does not compare all models to model.null
anova(model.null,
      model.All) %>%
  kable(caption = "ANOVA: Null and All") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: Null and No.Interaction") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: Null and No.Interaction.No.Target") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoSession) %>%
  kable(caption = "ANOVA: Null and No.Interaction.No.Session") %>%
  kable_styling()
```

The following models were significantly different from the null model: model.All,  model.NoInteraction, model.NoInteraction.NoTarget. 

model.All: Session Order, Target, and the interaction are included in this model.

model.NoInteraction: Session order and target are the fixed effects in this model.

model.NoInteraction.NoTarget: Session order is the only fixed effect in this model.

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.All <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "All", is.team = TRUE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

# Compare all of the models
anova(model.All,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: model.All and model.NoInteraction") %>%
  kable_styling()

anova(model.All,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: model.All and model.NoInteraction.NoTarget") %>%
  kable_styling()

anova(model.NoInteraction,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: model.NoInteraction and model.NoInteraction.NoTarget") %>%
  kable_styling()
```

Overall, model.All is not signifcantly different from model.NoInteraction.NoTarget or model.NoInteraction, indicating that the interaction effect can be ignored. The model model.NoInteraction is not significantly different from model.NoInteraction.NoTarget. However, the AIC and the BIC values are very similar. 

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

# Effect size (R^2)

r.squaredGLMM(model.NoInteraction.NoTarget) %>%
  kable(caption = "Table: Effect size for *No Interaction and No Target*") %>%
   kable_styling(full_width = F)

r.squaredGLMM(model.NoInteraction) %>%
  kable(caption = "Table: Effect size for *No Interaction*") %>%
   kable_styling(full_width = F)
```

I see no noticeable difference. The rule of thumb is to use the simplest model to represent the data. However, in this analysis I will examine __model.NoInteraction.NoTarget__ and __model.NoInteraction__ because the AIC and BIC values are close and the effect sizes are close. 



### GT

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.null <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "null", is.team = TRUE, is.robust =FALSE)
model.All <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "All", is.team = TRUE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoSession <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoSession", is.team = TRUE, is.robust = FALSE)

# There is an option to compare all the models with the anova(). However, the function does not compare all models to model.null
anova(model.null,
      model.All) %>%
  kable(caption = "ANOVA: Null and All") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: Null and No.Interaction") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: Null and No.Interaction.No.Target") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoSession) %>%
  kable(caption = "ANOVA: Null and No.Interaction.No.Session") %>%
  kable_styling()
```

The following models were significantly different from the null model: model.All,  model.NoInteraction, model.NoInteraction.NoTarget. 

model.All: Session Order, Target, and the interaction are included in this model.

model.NoInteraction: Session order and target are the fixed effects in this model.

model.NoInteraction.NoTarget: Session order is the only fixed effect in this model.


```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.All <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "All", is.team = TRUE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

# Compare all of the models
anova(model.All,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: model.All and model.NoInteraction") %>%
  kable_styling()

anova(model.All,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: model.All and model.NoInteraction.NoTarget") %>%
  kable_styling()

anova(model.NoInteraction,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: model.NoInteraction and model.NoInteraction.NoTarget") %>%
  kable_styling()
```

Overall, model.All is not signifcantly different from model.NoInteraction.NoTarget or model.NoInteraction, indicating that the interaction effect can be ignored. The model model.NoInteraction is not significantly different from model.NoInteraction.NoTarget. However, the AIC and the BIC values are very similar. 

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

# Effect size (R^2)

r.squaredGLMM(model.NoInteraction.NoTarget) %>%
  kable(caption = "Table: Effect size for *No Interaction and No Target*") %>%
   kable_styling(full_width = F)

r.squaredGLMM(model.NoInteraction) %>%
  kable(caption = "Table: Effect size for *No Interaction*") %>%
   kable_styling(full_width = F)
```

I see no noticeable difference. The rule of thumb is to use the simplest model to represent the data. However, in this analysis I will examine __model.NoInteraction.NoTarget__ and __model.NoInteraction__ because the AIC and BIC values are close and the effect sizes are close. 

## Individual 

### GA

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.null <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "null", is.team = FALSE, is.robust = FALSE)
model.All <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "All", is.team = FALSE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)
model.NoInteraction.NoSession <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoSession", is.team = FALSE, is.robust = FALSE)

# There is an option to compare all the models with the anova(). However, the function does not compare all models to model.null
anova(model.null,
      model.All) %>%
  kable(caption = "ANOVA: model.null and model.All") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: model.null and model.NoInteraction") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: model.null and model.NoInteraction.NoTarget") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoSession) %>%
  kable(caption = "ANOVA: model.null and model.NoInteraction.NoSession") %>%
  kable_styling()
```

The following models were significantly different from the null model: model.All,  model.NoInteraction, model.NoInteraction.NoTarget. 

model.All: Session Order, Target, and the interaction are included in this model.

model.NoInteraction: Session order and target are the fixed effects in this model.

model.NoInteraction.NoTarget: Session order is the only fixed effect in this model.

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.All <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "All", is.team = FALSE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

anova(model.All,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: All and No.Interaction") %>%
  kable_styling()

anova(model.All,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: All and NoInteraction.NoTarget") %>%
  kable_styling()

anova(model.NoInteraction,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: No.Interaction and NoInteraction.NoTarget") %>%
  kable_styling()
```

Overall, model.All is not signifcantly different from model.NoInteraction.NoTarget or model.NoInteraction, indicating that the interaction effect can be ignored. The model model.NoInteraction is not significantly different from model.NoInteraction.NoTarget. However, the AIC and the BIC values are very similar. 

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

# Effect size (R^2)

r.squaredGLMM(model.NoInteraction) %>%
  kable(caption = "Table: Effect size for *No Interaction*") %>%
   kable_styling(full_width = F)

r.squaredGLMM(model.NoInteraction.NoTarget) %>%
  kable(caption = "Table: Effect size for *No Interaction No Target*") %>%
   kable_styling(full_width = F)
```

I see no noticeable difference. The rule of thumb is to use the simplest model to represent the data. However, in this analysis I will examine __model.NoInteraction.NoTarget__ and __model.NoInteraction__ because the AIC and BIC values are close and the effect sizes are close. 

### GT

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.null <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "null", is.team = FALSE, is.robust = FALSE)
model.All <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "All", is.team = FALSE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)
model.NoInteraction.NoSession <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoSession", is.team = FALSE, is.robust = FALSE)

# There is an option to compare all the models with the anova(). However, the function does not compare all models to model.null
anova(model.null,
      model.All) %>%
  kable(caption = "ANOVA: model.null and model.All") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: model.null and model.NoInteraction") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: model.null and model.NoInteraction.NoTarget") %>%
  kable_styling()

anova(model.null,
      model.NoInteraction.NoSession) %>%
  kable(caption = "ANOVA: model.null and model.NoInteraction.NoSession") %>%
  kable_styling()
```

The following models were significantly different from the null model: model.All,  model.NoInteraction, model.NoInteraction.NoTarget. 

model.All: Session Order, Target, and the interaction are included in this model.

model.NoInteraction: Session order and target are the fixed effects in this model.

model.NoInteraction.NoTarget: Session order is the only fixed effect in this model.

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.All <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "All", is.team = FALSE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

anova(model.All,
      model.NoInteraction) %>%
  kable(caption = "ANOVA: All and No.Interaction") %>%
  kable_styling()

anova(model.All,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: All and NoInteraction.NoTarget") %>%
  kable_styling()

anova(model.NoInteraction,
      model.NoInteraction.NoTarget) %>%
  kable(caption = "ANOVA: No.Interaction and NoInteraction.NoTarget") %>%
  kable_styling()
```

Overall, model.All is not signifcantly different from model.NoInteraction.NoTarget or model.NoInteraction, indicating that the interaction effect can be ignored. The model model.NoInteraction is not significantly different from model.NoInteraction.NoTarget. However, the AIC and the BIC values are very similar. 

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

# Effect size (R^2)

r.squaredGLMM(model.NoInteraction) %>%
  kable(caption = "Table: Effect size for *No Interaction*") %>%
   kable_styling(full_width = F)

r.squaredGLMM(model.NoInteraction.NoTarget) %>%
  kable(caption = "Table: Effect size for *No Interaction No Target*") %>%
   kable_styling(full_width = F)
```

I see no noticeable difference. The rule of thumb is to use the simplest model to represent the data. However, in this analysis I will examine __model.NoInteraction.NoTarget__ and __model.NoInteraction__ because the AIC and BIC values are close and the effect sizes are close. 

## Summary

Overall, the results indicate that the Target has no influence on the scores at the team level or individual level when grouping the data by dominate strategy. 

# Q: Do the models satisfy the assumptions?

The purpose of this question is to see what we can learn from these models. Before I examine the model by generating diagnostic plots for the models. The assumptions are as follows [@Galwey2014]:

1. The residuals should have an approximately normal distribution (i.e., a bell curve) when plotted on a histogram.
2. A fitted-value plot should show an almost constant width when viewed from left to right.
3. The points on a normal plot should lie on an almost straight line from the bottom left to the top right.

The models may violate some of the assumptions. According to @Field2017, the best way to examine the influence of assumption violations is to compare a robust model to a standard model. When models violate assumptions, I will compare a robust model to a classic model. If there is a noticeable difference between the two models (i.e., if the estimated coefficient are noticeably different) then I will use a step on the power ladder to transform (@Tukey1977), or re-express, the data to address the assumption violation.

## Team

We learned that __model.NoInteraction.NoTarget__ and __model.NoInteraction__ best describe the team level data at the team level (see previous analysis). 

### Model.NoInteraction

#### GA

```{r}
# Plot location
setwd(figure_directory)

# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Team.png", sep = ""))

# Fitted values - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("FitteValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Team.png", sep = ""))

# QQ plots - model.NoInteraction
ggplot(model.NoInteraction, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for NoInteraction", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Team.png", sep = ""))
```

It looks like assumption 2 and 3 are violated. Need to analysis the influence of the violation. 

#### GT

```{r}
# Plot location
setwd(figure_directory)

# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace, "_Team.png", sep = ""))

# Fitted values - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("FitteValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace, "_Team.png", sep = ""))

# QQ plots - model.NoInteraction
ggplot(model.NoInteraction, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for NoInteraction", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace, "_Team.png", sep = ""))
```

It looks like assumption 2 and 3 are violated. Need to analysis the influence of the violation. 

### Model.NoInteraction.NoTarget

#### GA

```{r}
# Plot location
setwd(figure_directory)

# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction.NoTarget"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GA_name_NoSpace, "_Team.png", sep = ""))

# Fitted values - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction.NoTarget"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("FitteValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GA_name_NoSpace, "_Team.png", sep = ""))

# QQ plots - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for model.NoInteraction.NoTarget", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GA_name_NoSpace, "_Team.png", sep = ""))
```

It looks like assumption 2 and 3 are violated. Need to analysis the influence of the violation. 


#### GT

```{r}
# Plot location
setwd(figure_directory)

# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction.NoTarget"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GT_name_NoSpace, "_Team.png", sep = ""))

# Fitted values - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction.NoTarget"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("FitteValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GT_name_NoSpace, "_Team.png", sep = ""))

# QQ plots - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for model.NoInteraction.NoTarget", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(filename = paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GT_name_NoSpace, "_Team.png", sep = ""))
```

It looks like assumption 3 was violated. Need to analysis the influence of the violation. 


## Individual

We learned that __model.NoInteraction__ and __model.NoInteraction.NoTarget__ best describe the individual level data(see previous analysis).

### Model.NoInteraction

#### GA

```{r}
# Plot location
setwd(figure_directory)

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))

# Fitted values - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("FittedValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))


# QQ plots - model.NoInteraction
ggplot(model.NoInteraction, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for model.NoInteraction", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))
```

It looks like assumption 3 was violated. Need to analysis the influence of the violation. 

#### GT

```{r}
# Plot location
setwd(figure_directory)

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace , "Ind.png", sep =""))

# Fitted values - model.NoInteraction
ggplot(model.NoInteraction, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("FittedValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace , "Ind.png", sep =""))


# QQ plots - model.NoInteraction
ggplot(model.NoInteraction, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for model.NoInteraction", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteraction_", params$Strategy_GT_name_NoSpace , "Ind.png", sep =""))
```

It looks like assumption 3 was violated. Need to analysis the influence of the violation. 

### Model.NoInteraction.NoTarget

#### GA

```{r}
# Plot location
setwd(figure_directory)

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction.NoTarget"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))

# Fitted values - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction.NoTarget"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("FittedValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))


# QQ plots - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for model.NoInteraction.NoTarget", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GA_name_NoSpace, "_Ind.png", sep =""))
```

It looks like assumption 3 was violated. Need to analysis the influence of the violation. 


#### GT

```{r}
# Plot location
setwd(figure_directory)

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

# Histogram of Residuals - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .resid)) +
  geom_histogram(bins = 30) + 
  labs(title = paste("Histogram of Residuals for model.NoInteraction.NoTarget"), x = "", y = "") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("Histogram_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GT_name_NoSpace, "_Ind.png", sep =""))

# Fitted values - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(x = .fitted, y = .resid)) +
  geom_point() + 
  geom_hline(yintercept = 0)+
  labs(title = paste("Fitted-Value Plot for model.NoInteraction.NoTarget"), x = "Fitted Values", y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("FittedValue_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GT_name_NoSpace, "_Ind.png", sep =""))


# QQ plots - model.NoInteraction.NoTarget
ggplot(model.NoInteraction.NoTarget, aes(sample = .resid)) +
  stat_qq() +
  stat_qq_line()+
  labs(title = "Normal Q-Q Plot for model.NoInteraction.NoTarget", x = "Theoretical", y = "Sample") +
   theme(plot.title = element_text(hjust = 0.5)) +
  ggsave(paste("QQ_Residuals_", params$dependent_response_name_NoSpace, "_NoInteractionNoTarget_", params$Strategy_GT_name_NoSpace, "_Ind.png", sep =""))
```

It looks like assumption 1 and 3 were violated. Need to analysis the influence of the violation. 

## Summary

Overall, it looks like every model for every group (i.e., `r params$Strategy_GT_name_WithSpace` and `r params$Strategy_GA_name_WithSpace`) violates one or more assumptions. The next step is to see if the violations influence the model. 


# Q: Does the violation influence the linear model estimation?

I will use the robust estimation for linear mixed models found in the robustlmm package by @Koller2016. I will then compare the robust model to the non-robust model. If the estimated values are noticeably different, then data will need to be transformed. 

## Team

### Model.NoInteraction

#### GA
```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
rmodel.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction, rmodel.NoInteraction, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction") %>%
  kable_styling()
```

I do not see a concerning difference. I will not transform the data. 

#### GT

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)
rmodel.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction, rmodel.NoInteraction, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction") %>%
  kable_styling()
```

I do not see a concerning difference. I will not transform the data. 

### Model.NoInteraction.NoTarget

#### GA

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)
rmodel.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction.NoTarget, rmodel.NoInteraction.NoTarget, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction.NoTarget") %>%
  kable_styling()
```

I do not see a concerning difference. I will not transform the data. 


#### GT

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)
rmodel.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction.NoTarget, rmodel.NoInteraction.NoTarget, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction.NoTarget") %>%
  kable_styling()
```

I do not see a concerning difference. I will not transform the data.

## Individual

### Model.NoInteraction

#### GA

```{r}
#response_variable <- "II_ind"

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)
rmodel.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction, rmodel.NoInteraction, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction") %>%
  kable_styling()
```

I do not see a concerning difference. I will not transform the data.

#### GT

```{r}
#response_variable <- "II_ind"

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)
rmodel.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction, rmodel.NoInteraction, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction") %>%
  kable_styling()
```

I do not see a concerning difference. I will not transform the data.

### Model.NoInteraction.NoTarget

#### GA

```{r}
#response_variable <- "II_ind"

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)
rmodel.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction.NoTarget, rmodel.NoInteraction.NoTarget, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction.NoTarget") %>%
  kable_styling()
```

I do not see a concerning difference. I will not transform the data.

#### GT

```{r}
#response_variable <- "II_ind"

# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)
rmodel.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = TRUE)

comparision_results <- compare(model.NoInteraction.NoTarget, rmodel.NoInteraction.NoTarget, show.rho.functions = FALSE)

comparision_results %>%
  kable(caption = "model.NoInteraction") %>%
  kable_styling()
```

I do not see a concerning difference. I will not transform the data.

## Summary

Overall, I do not see a concerning difference for any of the violoations. I will not transform the data.

# Q: Are there any effects that are significant?

I want to determine if Target has a significant effect. I will examine the model itself, and then I will calculate the estimated marginal means to compare all three levels.

## Team

### Model.NoInteraction

#### GA

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

summary(model.NoInteraction)
```

Results show that the Target variable, in reference to the Ind level, has no significant effect. It also shows that the Session Order does not have a significant effect from session 3, in reference to session 2, but does have a significant effect from session 4. 

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ Target), adjust = "tukey")
```

The results show no statistical difference among the Target levels. 

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ SessionOrder), adjust = "tukey")
```

The results shows a significant difference between session 2 and 4, and between 3 and 4, indiciating team increased their score over time. 

#### GT

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

summary(model.NoInteraction)
```

Results showed a __marginally significant__ effect from the Team level in reference to the Ind level. Session 3 and 4 had a significant effect in reference to sesson 2.

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ Target), adjust = "tukey")
```

Results show no significant difference among the conditions. 

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction", is.team = TRUE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ SessionOrder), adjust = "tukey")
```

Results showed a singificant difference between session 2 and 3, and between session 2 and 4, Indicating that there was a significant inmprovement after session 2 but no significant improvement after that. 


### Model.NoInteraction.NoTarget

#### GA

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

summary(model.NoInteraction.NoTarget)
```

The results show that the Session Order does not have a significant effect from session 3, in reference to session 2, but does have a significant effect from session 4.

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GA_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

emmeans(model.NoInteraction.NoTarget, list(pairwise ~ SessionOrder), adjust = "tukey")
```

The results shows a significant difference between session 2 and 4, and between 3 and 4, indiciating team increased their score over time. 

#### GT

```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

summary(model.NoInteraction.NoTarget)
```

The results show a significant effect from session 3 and session 4, in reference to session 2.


```{r}
# Data to fit
data_modified_team <- team_data %>%
  select(TeamScore,
         params$dependent_response_team,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team)

# Generate models with variable response
GT_data_focus_team <- data_modified_team %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate robust and non-robust models - NoInteraction
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_team, dependent =  params$dependent_response_team, model.type =  "NoInteraction_NoTarget", is.team = TRUE, is.robust = FALSE)

emmeans(model.NoInteraction.NoTarget, list(pairwise ~ SessionOrder), adjust = "tukey")
```

The results show a significant differnet between session 2 and 3, and between session 2 and 4, indiciating teams improved their score between session 2 and 3, and between session 2 and 4, but there was no significant imrpovement after session 3. 

## Individual

### Model.NoInteraction

#### GA

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate models with variable response
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

summary(model.NoInteraction)
```

The results shows no significant effect from Target in reference to the Ind level. The results show a significant effect from session 3 and 4 in reference to session 2.

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate models with variable response
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ Target), adjust = "tukey")
```

The results show no significant difference between any of the Target levels.

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate models with variable response
model.NoInteraction <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ SessionOrder), adjust = "tukey")
```

The result show a singificant difference between each session, indicating that individal score is increasing overtime. 

#### GT

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate models with variable response
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

summary(model.NoInteraction)
```

The results show no significant effect from Target in reference to the Ind level. The results show a significant effect from session 3 and 4 in reference to session 2

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate models with variable response
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ Target), adjust = "tukey")
```

The results show no significant difference among the conditions.

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate models with variable response
model.NoInteraction <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction", is.team = FALSE, is.robust = FALSE)

emmeans(model.NoInteraction, list(pairwise ~ SessionOrder), adjust = "tukey")
```

The results shows a significant difference among all the session, indicating the individual score increased over time. 

### Model.NoInteraction.NoTarget

#### GA

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate models with variable response
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

summary(model.NoInteraction.NoTarget)
```

The results show a singificant effect from session 3 and 4 in reference to session 2. 

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GA_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GA_name_WithSpace)

# Generate models with variable response
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GA_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

emmeans(model.NoInteraction.NoTarget, list(pairwise ~ SessionOrder), adjust = "tukey")
```

The results show a significant difference from each session, indiciating individual score increased over time.

#### GT

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate models with variable response
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

summary(model.NoInteraction.NoTarget)
```

The results show a significant effect from session 2 and 4 in reference to session 2. 

```{r}
# Data to model
data_modified_ind <- ind_data %>%
  select(params$dependent_response_ind,
         params$dependent_response_DominateStrategy,
         Target, 
         SessionOrder, 
         Team, 
         Player_ID)

# Generate models with variable response
GT_data_focus_ind <- data_modified_ind %>%
  filter(.data[[params$dependent_response_DominateStrategy]] == params$Strategy_GT_name_WithSpace)

# Generate models with variable response
model.NoInteraction.NoTarget <- model_data_Target_Session(df = GT_data_focus_ind, dependent =  params$dependent_response_ind, model.type =  "NoInteraction_NoTarget", is.team = FALSE, is.robust = FALSE)

emmeans(model.NoInteraction.NoTarget, list(pairwise ~ SessionOrder), adjust = "tukey")
```

The results show a significant ifference among all sessions, inficating the individual score increased over time.

## Summary


Overall, there the Target variable had no significant influence on the scores when grouped by strategy (i.e., `r params$Strategy_GT_name_WithSpace` and `r params$Strategy_GA_name_WithSpace`). 

# References





















